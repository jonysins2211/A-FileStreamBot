<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Play</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background-color: #0d1117;
      color: #fff;
      padding: 20px;
    }
    h2 {
      margin-bottom: 20px;
    }
    .btn {
      display: inline-block;
      margin: 10px;
      padding: 12px 18px;
      font-size: 16px;
      font-weight: bold;
      text-decoration: none;
      border-radius: 8px;
      background: #1f6feb;
      color: #fff;
      transition: background 0.3s ease;
      cursor: pointer;
    }
    .btn:hover {
      background: #1158c7;
    }
    video {
      width: 100%;
      max-width: 720px;
      margin-top: 20px;
      border-radius: 12px;
    }
  </style>
</head>
<body>

  <h2>ðŸŽ¬ Watch Video</h2>

  <!-- HTML5 Player -->
  <video controls>
    <source src="{{ file_dl_url }}" type="video/mp4">
    Your browser does not support the video tag.
  </video>

  <!-- External Players -->
  <div>
    <a href="vlc://{{ file_dl_url }}" class="btn">Play in VLC</a>
    <a href="javascript:void(0);" onclick="openMxPlayer()" class="btn">Play in MX Player</a>
    <a href="nplayer-{{ file_dl_url }}" class="btn">Play in nPlayer</a>
  </div>

  <!-- Download + Copy -->
  <div>
    <a href="{{ file_dl_url }}" class="btn">â¬‡ Download</a>
    <button onclick="copyLink()" class="btn">ðŸ“‹ Copy Link</button>
  </div>

  <script>
    const fileUrl = "{{ file_dl_url }}";

    // Copy link to clipboard
    function copyLink() {
      navigator.clipboard.writeText(fileUrl).then(() => {
        alert("Link copied to clipboard!");
      }).catch(() => {
        alert("Failed to copy link. Please copy manually.");
      });
    }

    // Universal MX Player opener
    function openMxPlayer() {
      // Try Free version first
      const intentFree = `intent:${fileUrl}#Intent;package=com.mxtech.videoplayer.ad;end`;
      const intentPro  = `intent:${fileUrl}#Intent;package=com.mxtech.videoplayer.pro;end`;

      // Fallback method: try Free, then Pro
      window.location.href = intentFree;
      setTimeout(() => {
        window.location.href = intentPro;
      }, 1500);
    }
  </script>

</body>
</html>
